/**
 * Created by Ch on 16/5/23.
 @Name : ChPaging v1.0.1 分页插件
 @Author: Ch/chenhui
 @Date: 2016/5/23
 @QQ：894684604
 @官网： https://cwlch.github.io/Ch_Paging/index.html
 *
 */
!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):a.ChPaging=b()}(this,function(){"use strict";var a={first:!0,last:!0,viewNumber:!0,current:1,viewOpt:[10,20,50,100],limit:10,jump:!0,viewCountPage:!0,viewCountNumber:!0,classPrefix:"Ch",txtConfig:{first:"首页",last:"尾页",next:"下一页",prev:"上一页",jumpBtn:"go",jumpTxt:"跳转到{n}页",countPage:"共{n}页",countNumber:"共{n}条",viewNumber:"每页显示{n}条"}},b={init:function(a){var d,i,e,f,g,h,b=a.o,c="";if(b.first&&(c+='<a href="javascript:;" id="ChPagingFirst" class="'+b.classPrefix+'_paging_first">'+b.txtConfig.first+"</a>"),c+='<a href="javascript:;" id="ChPagingPrev" class="'+b.classPrefix+'_paging_prev">'+b.txtConfig.prev+'</a><span  id="ChPagingBtns" class="'+b.classPrefix+'_paging_btn"></span><a href="javascript:;" id="ChPagingNext" class="'+b.classPrefix+'_paging_next">'+b.txtConfig.next+"</a>",b.last&&(c+='<a href="javascript:;" id="ChPagingLast" class="'+b.classPrefix+'_paging_last">'+b.txtConfig.last+"</a>"),b.viewNumber){for(d="",e=0,f=b.limit,g="",h=b.viewOpt.length;h>e;e++)i=b.viewOpt[e],g=i===f?"selected":"",d+='<option value="'+i+'"'+g+">"+i+"</option>";c+='<span class="'+b.classPrefix+'_paging_view_number"><label>'+b.txtConfig.viewNumber.replace(/^(.+)\{n\}(.+)$/,"$1")+'</label><select id="ChPagingViewNum">'+d+"</select><label>"+b.txtConfig.viewNumber.replace(/^(.+)\{n\}(.+)$/,"$2")+"</label></span>"}b.jump&&(c+='<span class="'+b.classPrefix+'_paging_jump"><label>'+b.txtConfig.jumpTxt.replace(/^(.+)\{n\}(.+)$/,"$1")+'</label><input type="text"  id="ChPagingJumpNum"/><label>'+b.txtConfig.jumpTxt.replace(/^(.+)\{n\}(.+)$/,"$2")+'</label><button id="ChPagingJumpBtn">go</button></span>'),b.viewCountPage&&(c+='<span id="ChPagingCount" class="'+b.classPrefix+'_paging_count_page"></span>'),b.viewCountNumber&&(c+='<span id="ChPagingCountNumber" class="'+b.classPrefix+'_paging_count_number"></span>'),a.$target.html(c),a.$pages=a.$target.find("#ChPagingBtns")},reloadPages:function(a,b,c){var f,g,h,d="",e="",i=a.pageCount,j=a.current;for(c.find("#ChPagingCount").html(a.txtConfig.countPage.replace(/^(.+)\{n\}(.+)$/,"$1")+i+a.txtConfig.countPage.replace(/^(.+)\{n\}(.+)$/,"$2")),c.find("#ChPagingCountNumber").html(a.txtConfig.countNumber.replace(/^(.+)\{n\}(.+)$/,"$1")+a.count+a.txtConfig.countNumber.replace(/^(.+)\{n\}(.+)$/,"$2")),h=i>10?8:10,j>=9?(f=j-7,j==i?(f=j-9,h=10):j==i-1&&(f=j-8,h=9)):f=1,g=f+h,10>i&&(g=i+1);g>f;f++)e=f==j?"class='"+a.classPrefix+"_Paging_choose'":"",d+='<a href="javascript:;" name="'+f+'" '+e+">"+f+"</a>";i>10&&j!=i-1&&j!=i&&(d+='<a href="javascript:;" class="'+a.classPrefix+'_Paging_more" name="more" index="'+f+'">...</a>'),i>10&&j!=i&&(d+='<a href="javascript:;" name="'+i+'">'+i+"</a>"),b.html(d)}},c={init:function(a){var c=a.o;a.static.start=1,c.xhr?this.xhrReload(a):(c.count=c.data.length,a.static.end=c.limit,b.init(a),this.reloadListCbk(a)),this.eventBind(a)},operationReady:function(a,b){var c=a.o,d=b||{evnt:"default",type:"default"};a.static.end=c.current*c.limit,a.static.end=c.count?a.static.end<=c.count?a.static.end:c.count:c.limit,a.static.start=a.static.end-c.limit+1,d.start=a.static.start,d.end=a.static.end,c.count&&(d.count=c.count),c.current&&(d.current=c.current),c.limit&&(d.limit=c.limit),c.operReady&&c.operReady(d),c.xhr?this.xhrReload(a,d):this.reloadListCbk(a,d)},xhrReload:function(a,c){var d=this,e=a.o;$.ajax(e.xhr).then(function(f){var g=e.xhrSuccess(f);e.data=g.data,e.count=g.count,c||b.init(a),d.reloadListCbk(a,c)})},reloadListCbk:function(a){var d,e,c=a.o;if(a.reloadPages(),c.xhr)d=c.data;else for(d=[],e=a.static.start;e<a.static.end;e++)d.push(c.data[e]);c.operFinsh&&c.operFinsh(d)},eventBind:function(a){var b=$(a),c=this,d=a.o,e=function(b,d){c.operationReady(a,d)},f={};b.on("jump",e).on("viewNum",e),d.viewNumber&&a.$target.on("change","#ChPagingViewNum",function(){var a=$(this),c=a.val();d.current=1,d.limit=c,f={evnt:"viewNum",type:"option"},b.trigger("viewNum",[f])}),d.jump&&a.$target.on("click","#ChPagingJumpBtn",function(){var a=$("#ChPagingJumpNum").val();d.current=a||d.current,f={evnt:"jump",type:"target"},b.trigger("jump",[f])}),a.$target.on("click","#ChPagingBtns a",function(){var e,a=$(this),c=a.attr("name");"more"===c?(e=a.attr("index"),d.current=e,f={evnt:"jump",type:"more"},b.trigger("jump",[f])):(d.current=c,f={evnt:"jump",type:"target"},b.trigger("jump",[f]))}).on("click","#ChPagingFirst",function(){d.current=1,f={evnt:"jump",type:"first"},b.trigger("jump",[f])}).on("click","#ChPagingLast",function(){d.current=d.pageCount,f={evnt:"jump",type:"last"},b.trigger("jump",[f])}).on("click","#ChPagingNext",function(){d.current++,d.current>d.pageCount&&(d.current=d.pageCount),f={evnt:"jump",type:"next"},b.trigger("jump",[f])}).on("click","#ChPagingPrev",function(){d.current--,d.current<=0&&(d.current=1),f={evnt:"jump",type:"prev"},b.trigger("jump",[f])})}},d=function(b,d){this.$target=$(b),this.o=$.extend(!0,{},a,d),this.static={},c.init(this)};return d.prototype={set:function(a){$.extend(!0,this.o,a)},get:function(a){return this.o[a]||this.static[a]},reloadPages:function(){var a=this.o;a.pageCount=Math.ceil(a.count/a.limit),a.current>a.pageCount&&(a.current=a.pageCount),b.reloadPages(a,this.$pages,this.$target)}},d});